<!DOCTYPE HTML>



<html lang="th">
	<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta name="description" content="บทเรียนเกี่ยวกับภาษา Elixir">
  <meta name="author" content="Sean Callan">

  <meta property="og:url" content="http://localhost:4000/th/lessons/specifics/mnesia/">
  <meta property="og:site_name" content="ElixirSchool">
  <meta property="og:title" content="โรงเรียน Elixir">
  <meta property="og:locale" content="th">
  <meta property="og:description" content="บทเรียนเกี่ยวกับภาษา Elixir">
  <meta property="og:image" content="http://localhost:4000/assets/og_image-fad975b316dea5dc361d199bdfaa076006da49a0a3296f799aa7217b4c8b0cbe.jpg">
  
  
    
    
    
    
      <link rel="alternate" hreflang="en" href="/en/lessons/specifics/mnesia/" />
      <link rel="alternate" hreflang="x-default" href="/en/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="es" href="/es/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="el" href="/gr/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="id" href="/id/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="ko" href="/ko/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="pl" href="/pl/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="pt" href="/pt/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="ru" href="/ru/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="th" href="/th/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="vi" href="/vi/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="zh-hans" href="/zh-hans/lessons/specifics/mnesia/" />
    
  
    
    
    
    
      <link rel="alternate" hreflang="zh-hant" href="/zh-hant/lessons/specifics/mnesia/" />
    
  

  <link rel="canonical" href="http://localhost:4000/th/lessons/specifics/mnesia/">
  <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/favicons/apple-touch-icon-06ad80501b5734bba0428ca0fc14fcbe45811a144914f7be78cdab3c3ea25458.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/favicons/favicon-32x32-6e7b9eca57d29d185a5184e844c1372ce9da0a71f373f89b80ff11f120b01678.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/favicons/favicon-16x16-789b56195138252cac40cf7f2425b6fcb4e71c3084abc8525781188781b958d3.png">
  <link rel="manifest" href="http://localhost:4000/manifest.json">
  <link rel="shortcut icon" href="http://localhost:4000/assets/favicons/favicon-8e1fdc2a44d6344b9871b3ecf53a803903891f82a602a3f59c65eda40f2b77b0.ico">
  <link rel="alternate" type="application/rss+xml" title="Elixir School" href="https://elixirschool.com/feed.xml" />
  <meta name="msapplication-config" content="http://localhost:4000/assets/favicons/browserconfig-e66282a6754e6899f9a53c6ebfe120749630242b741deb65f364abc297ccbc96.xml">
  <meta name="theme-color" content="#ffffff">

  
  
  <title>Mnesia &middot; โรงเรียน Elixir</title>
  <!-- CSS -->
  <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" type="text/css" href="/assets/main-07a5a32c1a26652d2bb0e43b4c7ade37f20599a76cae3c1e871d3af53cff80b2.css">
  <!--[if lte IE 9]><link rel="stylesheet" type="text/css" href="/assets/ie9-0c07c3ea146a3dd5dce4effda97b3718824cab9c30149877c0e445edecfdee60.css"><![endif]-->
  <!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/assets/ie8-f0c85ce6ad95a6d33929cb969a44f41a5e96ecb22de55f55d0f3c83cfc0012fc.css"><![endif]-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
  <script type="text/javascript">
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
  analytics.load("C0p07Sw9j7mZnycKDCgPOAyqJR5hhyoQ");
  analytics.page()
  }}();
  </script>
  <script type="text/javascript">
    if ("serviceWorker" in navigator) {
      if (!navigator.serviceWorker.controller) {
        navigator.serviceWorker.register("http://localhost:4000/serviceworker.js", {
          scope: "http://localhost:4000"
        })
        .then(reg => console.log("Service worker has been registered for scope: ", reg.scope))
        .catch(error => console.log("Service worker registration has failed: ", error));
      }
    }  
  </script>
</head>

	<body class="is-loading">
    <script type="text/javascript">
    var $theme = localStorage.getItem('theme');
    if ($theme === 'dark') document.body.classList.add("dark");
    </script>
		<!-- Wrapper -->
		<div id="wrapper">
			<!-- Main -->
			<div id="main">
				<div class="inner">
					<!-- Header -->
					<header id="header">
					  <a href="/th/" class="logo"><strong>Elixir School</strong></a>
					  <ul class="icons">
  
  <li><iframe src="https://ghbtns.com/github-btn.html?user=elixirschool&repo=elixirschool&type=star&count=true" height="20" title="GitHub Stars" width="93" style="vertical-align: sub;"></iframe></li>
  <li><a target="_blank" rel="noopener" title="RSS" href="https://elixirschool.com/feed.xml" class="icon fa-rss-square"><span class="label">RSS</span></a></li>
  <li><a target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/th/lessons/specifics/mnesia/&title=Mnesia&summary=description&source=http://localhost:4000" class="icon fa-linkedin"><span class="label">Linkedin</span></a></li>
  <li><a target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/intent/tweet?url=http://localhost:4000/th/lessons/specifics/mnesia/&via=elixirschool&text=ElixirSchool: Mnesia&hashtags=learnelixir%2Celixirlang&" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
  <li><a target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/th/lessons/specifics/mnesia/" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
  <li><a target="_blank" rel="noopener" title="Pinterest" href="https://www.pinterest.com/pin/create/link/?url=http://localhost:4000/th/lessons/specifics/mnesia/&media=http://localhost:4000/assets/og_image-fad975b316dea5dc361d199bdfaa076006da49a0a3296f799aa7217b4c8b0cbe.jpg&description=ElixirSchool: Mnesia" class="icon fa-pinterest"><span class="label">Pinterest</span></a></li>
  <li><a target="_blank" rel="noopener" title="VK" href="https://vk.com/share.php?url=http://localhost:4000/th/lessons/specifics/mnesia/&title=ElixirSchool: Mnesia&description=Check out 'Mnesia' on ElixirSchool" class="icon fa-vk"><span class="label">VK</span></a></li>
  <li><a target="_blank" rel="noopener" title="Email" href="mailto:?to=&subject=ElixirSchool: Mnesia&body=Check out 'Mnesia' on ElixirSchool%0D%0A%0D%0Ahttp://localhost:4000/th/lessons/specifics/mnesia/" class="icon fa-envelope"><span class="label">Email</span></a></li>
  <li><a title="Print" href="javascript:window.print()" class="icon fa-print"><span class="label">Print</span></a></li>
</ul>

					</header>
					<section id="section-page" class="ltr">
  <header class="main">
    
    <h1 class="page-title">
  <span class="version-difference-indicator version-difference-minor"></span>
  Mnesia
</h1>
<div class="version-info version-info-minor">
  <span>
    
      เนื้อหาบางส่วนของบทแปลฉบับนี้อาจล้าสมัย<br/>
    

    ต้นฉบับมีการเปลี่ยนแปลงรายย่อยเกิดขึ้นเป็นจำนวนมากนับตั้งแต่การปรับปรุงครั้งล่าสุด
  </span>
</div>

    
  </header>
  <div class="content">
    <p>Mnesia เป็นระบบจัดการ distributed database ที่ทำงานแบบ real-time</p>

<h2>สารบัญ</h2>
<div id="toc"></div>

<h2 id="ภาพรวม">ภาพรวม</h2>

<p>Mnesia เป็น database management system (DBMS) ที่มาพร้อมกับ Erland runtime system ซึ่งเราก็สามารถใช้มันได้กับ Elixir ทันที <em>relational and object hybrid data model</em> เป็นสิ่งที่ทำให้ Mnesia เหมาะกับการสร้างแอพแบบ distributed ในทุกระดับ</p>

<h2 id="เมื่อไหร่ที่ควรใช้">เมื่อไหร่ที่ควรใช้</h2>

<p>เมื่อไหร่ที่ควรเลืิอกใช้ส่วนต่างๆ ของเทคโนโลยี เป็นสิ่งที่ทำให้เราสับสนมาตลอด ถ้าคุณตอบว่า “ใช่” สำหรับคำถามต่อไปนี้ นั่นแหละเป็นตัววัดที่ดีว่าควรจะใช้ Mnesia แทน ETS หรือ DETS</p>

<ul>
  <li>คุณต้องการ roll back transaction ไหม?</li>
  <li>คุณต้องการ syntax ที่ใช้ง่ายสำหรับการอ่านและเขียนข้อมูลไหม?</li>
  <li>คุณต้องการจะเก็บข้อมูลระหว่าง node หรือมากกว่า 1 node ไหม?</li>
  <li>คุณต้องการตัวเลือกว่าจะเก็บข้อมูลไว้ที่ไหนไหม (RAM หรือ disk)?</li>
</ul>

<h2 id="schema">Schema</h2>

<p>เนื่องจาก Mnesia เป็นส่วนหนึ่งของ Erlang core มากกว่า Elixir เราจึงสามารถเข้าใช้งานมันด้วย colon syntax (ดูบท <a href="../../advanced/erlang/">Erlang Interoperability</a>):</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:mnesia</span><span class="o">.</span><span class="n">create_schema</span><span class="p">([</span><span class="n">node</span><span class="p">()])</span>

<span class="c1"># or if you prefer the Elixir feel...</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="n">alias</span> <span class="ss">:mnesia</span><span class="p">,</span> <span class="ss">as:</span> <span class="no">Mnesia</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">create_schema</span><span class="p">([</span><span class="n">node</span><span class="p">()])</span>
</code></pre></div></div>

<p>สำหรับบทนี้ เราจะมาดูกันต่อเกี่ยวกับการใช้งาน Mnesia API <code class="highlighter-rouge">Mnesia.create_schema/1</code> จะสร้าง schema ว่างๆ ขึ้นมาใหม่ แล้วส่งไปให้ Node List ณ จุดนี้ เราจะส่งระหว่าง node ที่อยู่ใน IEx session ของเรา</p>

<h2 id="nodes">Nodes</h2>

<p>หลังจากที่เรา run คำสั่ง <code class="highlighter-rouge">Mnesia.create_schema([node()])</code> ผ่าน IEx คุณควรจะเห็น folder ชื่อ <strong>Mnesia.nonode@nohost</strong> หรืออะไรที่คล้ายๆ กัน ใน directory ที่คุณใช้งานอยู่ คุณอาจจะสงสัยว่า <strong>nonode@nohost</strong>  คืออะไร เพราะเราไม่เคยเห็นมันมาก่อน ดังนั้น มาดูสักหน่อย</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>iex <span class="nt">--help</span>
Usage: iex <span class="o">[</span>options] <span class="o">[</span>.exs file] <span class="o">[</span>data]

  <span class="nt">-v</span>                Prints version
  <span class="nt">-e</span> <span class="s2">"command"</span>      Evaluates the given <span class="nb">command</span> <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">-r</span> <span class="s2">"file"</span>         Requires the given files/patterns <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">-S</span> <span class="s2">"script"</span>       Finds and executes the given script
  <span class="nt">-pr</span> <span class="s2">"file"</span>        Requires the given files/patterns <span class="k">in </span>parallel <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">-pa</span> <span class="s2">"path"</span>        Prepends the given path to Erlang code path <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">-pz</span> <span class="s2">"path"</span>        Appends the given path to Erlang code path <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">--app</span> <span class="s2">"app"</span>       Start the given app and its dependencies <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">--erl</span> <span class="s2">"switches"</span>  Switches to be passed down to Erlang <span class="o">(</span><span class="k">*</span><span class="o">)</span>
  <span class="nt">--name</span> <span class="s2">"name"</span>     Makes and assigns a name to the distributed node
  <span class="nt">--sname</span> <span class="s2">"name"</span>    Makes and assigns a short name to the distributed node
  <span class="nt">--cookie</span> <span class="s2">"cookie"</span> Sets a cookie <span class="k">for </span>this distributed node
  <span class="nt">--hidden</span>          Makes a hidden node
  <span class="nt">--werl</span>            Uses Erlang<span class="s1">'s Windows shell GUI (Windows only)
  --detached        Starts the Erlang VM detached from console
  --remsh "name"    Connects to a node using a remote shell
  --dot-iex "path"  Overrides default .iex.exs file and uses path instead;
                    path can be empty, then no file will be loaded

** Options marked with (*) can be given more than once
** Options given after the .exs file or -- are passed down to the executed code
** Options can be passed to the VM using ELIXIR_ERL_OPTIONS or --erl
</span></code></pre></div></div>

<p>เมื่อเราส่งค่า <code class="highlighter-rouge">--help</code> option เข้าไปใน IEx ผ่าน command line เราก็จะเห็น option ทั้งหมดที่เราใช้งานได้ เราจะเห็น option <code class="highlighter-rouge">--name</code> และ <code class="highlighter-rouge">--sname</code> สำหรับการกำหนดข้อมูลให้กับ node node คือ Erlang virtual machine ที่ทำการดูแลการสื่อสาร, garbage collection, process scheduling, memory และอีกมากมาย โดย node จะมีชื่อ <strong>nonode@nohost</strong> ง่ายๆ โดย default</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>iex <span class="nt">--name</span> learner@elixirschool.com

Erlang/OTP 22.0 <span class="o">[</span>erts-10.5.3] <span class="o">[</span><span class="nb">source</span><span class="o">]</span> <span class="o">[</span>64-bit] <span class="o">[</span>smp:4:4] <span class="o">[</span>async-threads:10] <span class="o">[</span>hipe] <span class="o">[</span>kernel-poll:false] <span class="o">[</span>dtrace]

Interactive Elixir <span class="o">(</span>1.10.1<span class="o">)</span> - press Ctrl+C to <span class="nb">exit</span> <span class="o">(</span><span class="nb">type </span>h<span class="o">()</span> ENTER <span class="k">for </span><span class="nb">help</span><span class="o">)</span>
iex<span class="o">(</span>learner@elixirschool.com<span class="o">)&gt;</span> Node.self
:<span class="s2">"learner@elixirschool.com"</span>
</code></pre></div></div>

<p>อย่างที่เราได้เห็นกัน node ที่เรากำลัง run คือ atom ชื่อ <code class="highlighter-rouge">:"learner@elixirschool.com"</code> ถ้าเราสั่ง run <code class="highlighter-rouge">Mnesia.create_schema([node()])</code> อีกครั้ง เราจะเห็นว่ามันจะสร้าง folder ใหม่ขึ้นมาชื่อ <strong>Mnesia.learner@elixirschool.com</strong> จุดประสงค์ของมันง่ายนิดเดียว นั่นคือ node ใน Erlang จะเชื่อมต่อกับ node  อื่นๆ เพื่อ share (distribute) ข้อมูลและ resources กันและกัน. และมันไม่ได้จำกัดอยู่แค่ภายในเครื่องเดียวกัน มันสามารถสื่อสารกันผ่าน LAN หรือ internet</p>

<h2 id="starting-mnesia">Starting Mnesia</h2>

<p>ตอนนี้เรามีพื้นฐานเกี่ยวกับการ set up database แล้ว เราพร้อมแล้วที่จะใช้งาน Mnesia DBMS ด้วยคำสั่ง <code class="highlighter-rouge">Mnesia.start/0</code></p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="n">alias</span> <span class="ss">:mnesia</span><span class="p">,</span> <span class="ss">as:</span> <span class="no">Mnesia</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">create_schema</span><span class="p">([</span><span class="n">node</span><span class="p">()])</span>
<span class="ss">:ok</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="ss">:ok</span>
</code></pre></div></div>

<p>มันคุ้มค่าถ้าจะจดจำไว้ว่าเมื่อสั่งให้มัน run บน distrubuted system ที่มี node มากกว่า 2 node ขึ้นไป, function <code class="highlighter-rouge">Mnesia.start/1</code> จะต้องรันในทุก node ที่เกี่ยวข้อง</p>

<h2 id="creating-tables">Creating Tables</h2>

<p>function <code class="highlighter-rouge">Mnesia.create_table/2</code> ใช้สำหรับสร้างตารางภายใน database ของเรา คำสั่งด้านล่างนี้เราได้ทำการสร้างตารางชื่อ <code class="highlighter-rouge">Person</code> และส่ง ketword list ที่ใช้กำหนด schema ของตารางเข้าไป</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="p">[</span><span class="ss">attributes:</span> <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">]])</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="ss">:ok</span><span class="p">}</span>
</code></pre></div></div>

<p>เราได้กำหนด column โดยใช้ atom <code class="highlighter-rouge">:id</code>, <code class="highlighter-rouge">:name</code>, และ <code class="highlighter-rouge">:job</code> เมื่อเรารัน <code class="highlighter-rouge">Mnesia.create_table/2</code> มันจะคืนค่าใดค่าหนึ่งต่อไปนี้ออกมา</p>

<ul>
  <li><code class="highlighter-rouge">{:atomic, :ok}</code> ถ้า function ทำงานสำเร็จ</li>
  <li><code class="highlighter-rouge">{:aborted, Reason}</code> ถ้า function ทำงานล้มเหลว</li>
</ul>

<p>โดยปกติแล้ว ถ้าตารางได้ถูกสร้างไว้แล้ว Reason จะเป็น <code class="highlighter-rouge">{:already_exists, table}</code> ดังนั้นถ้าเราพยายามจะสร้างตารางขึ้นมาเป็นครั้งที่สอง เราจะได้ค่า</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="p">[</span><span class="ss">attributes:</span> <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">]])</span>
<span class="p">{</span><span class="ss">:aborted</span><span class="p">,</span> <span class="p">{</span><span class="ss">:already_exists</span><span class="p">,</span> <span class="no">Person</span><span class="p">}}</span>
</code></pre></div></div>

<h2 id="the-dirty-way">The Dirty Way</h2>

<p>อันดับแรก เราจะมาดู dirty way ของการอ่านและเขียนตาราง Mnesia กัน สิ่งเหล่านี้ควรจะหลีกเลี่ยงเนื่องจากผลลัพธ์อาจจะไม่สำเร็จ แต่มันจะช่วยให้เราได้เรียนรู้และรู้สึกคุ้นเคยกับการทำงานของ Mnesia มากขึ้น เริ่มจากลองเพิ่ม entry เข้าไปในตาราง <strong>Person</strong></p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"Seymour Skinner"</span><span class="p">,</span> <span class="s2">"Principal"</span><span class="p">})</span>
<span class="ss">:ok</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"Homer Simpson"</span><span class="p">,</span> <span class="s2">"Safety Inspector"</span><span class="p">})</span>
<span class="ss">:ok</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">"Moe Szyslak"</span><span class="p">,</span> <span class="s2">"Bartender"</span><span class="p">})</span>
<span class="ss">:ok</span>
</code></pre></div></div>

<p>…และ เอาค่าออกมาจาก entry ด้วย <code class="highlighter-rouge">Mnesia.dirty_read/1</code>:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_read</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">1</span><span class="p">})</span>
<span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"Seymour Skinner"</span><span class="p">,</span> <span class="s2">"Principal"</span><span class="p">}]</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_read</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">2</span><span class="p">})</span>
<span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"Homer Simpson"</span><span class="p">,</span> <span class="s2">"Safety Inspector"</span><span class="p">}]</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_read</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">3</span><span class="p">})</span>
<span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">"Moe Szyslak"</span><span class="p">,</span> <span class="s2">"Bartender"</span><span class="p">}]</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">dirty_read</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">4</span><span class="p">})</span>
<span class="p">[]</span>
</code></pre></div></div>

<p>ถ้าเราพยายามจะดึงค่า record ที่ไม่เคยมี Mnesia จะคืน empty list ออกมาให้</p>

<h2 id="transactions">Transactions</h2>

<p>ปกติแล้วเราจะใช้ <strong>transaction</strong> เพื่อ encapsulate การเขียนหรืออ่านกับ database ของเรา Transaction เป็นส่วนสำคัญของการออกแบบ fault-tolerant, highly distributed systems <em>Transaction ของ Mnesia มีกลไกที่ทำให้ database operation ทำงานตามลำดับแบบ functional block</em> เริ่มจากสร้าง anonymous function ในที่นี้คือ <code class="highlighter-rouge">data_to_write</code> และส่งเข้าไปใน <code class="highlighter-rouge">Mnesia.transaction</code></p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="n">data_to_write</span> <span class="o">=</span> <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>   <span class="no">Mnesia</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">"Marge Simpson"</span><span class="p">,</span> <span class="s2">"home maker"</span><span class="p">})</span>
<span class="o">...&gt;</span>   <span class="no">Mnesia</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">"Hans Moleman"</span><span class="p">,</span> <span class="s2">"unknown"</span><span class="p">})</span>
<span class="o">...&gt;</span>   <span class="no">Mnesia</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">"Monty Burns"</span><span class="p">,</span> <span class="s2">"Businessman"</span><span class="p">})</span>
<span class="o">...&gt;</span>   <span class="no">Mnesia</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">"Waylon Smithers"</span><span class="p">,</span> <span class="s2">"Executive assistant"</span><span class="p">})</span>
<span class="o">...&gt;</span> <span class="k">end</span>
<span class="c1">#Function&lt;20.54118792/0 in :erl_eval.expr/5&gt;</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="ss">:ok</span><span class="p">}</span>
</code></pre></div></div>
<p>จากข้อความ transaction ที่ได้ เราสามารถสมมติได้ว่าเราได้ทำการเขียนข้อมูลลงในตาราง <code class="highlighter-rouge">Person</code> แล้ว คราวนี้ลองใช้ transaction ในการอ่านค่าจาก database เพื่อให้แน่ใจว่ามีเขียนแล้ว โดยเราจะใช้ <code class="highlighter-rouge">Mnesia.read/1</code> เพื่ออ่านค่าจาก database แต่จะใช้ในรูปของ anonymous function</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="n">data_to_read</span> <span class="o">=</span> <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>   <span class="no">Mnesia</span><span class="o">.</span><span class="n">read</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">6</span><span class="p">})</span>
<span class="o">...&gt;</span> <span class="k">end</span>
<span class="c1">#Function&lt;20.54118792/0 in :erl_eval.expr/5&gt;</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span><span class="n">data_to_read</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">"Monty Burns"</span><span class="p">,</span> <span class="s2">"Businessman"</span><span class="p">}]}</span>
</code></pre></div></div>

<p>จำไว้ว่าถ้าคุณต้องการจะ update ข้อมูล คุณจะต้องเรียกใช้ <code class="highlighter-rouge">Mnesia.write/1</code> ด้วย key เดียวกันกับ record ที่มีอยู่ ดังนั้นถ้าจะ update record สำหรับ Hans คุณก็แค่</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span>
<span class="o">...&gt;</span>   <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">"Hans Moleman"</span><span class="p">,</span> <span class="s2">"Ex-Mayor"</span><span class="p">})</span>
<span class="o">...&gt;</span>   <span class="k">end</span>
<span class="o">...&gt;</span> <span class="p">)</span>
</code></pre></div></div>

<h2 id="using-indices">Using indices</h2>

<p>Mnesia รองรับการทำงานกับ index สำหรับ columnที่ไม่มี key และข้อมูลจะถูก query ตาม index นั้นๆ ดังนั้นเราสามารถเพิ่ม index ให้กับ column <code class="highlighter-rouge">:job</code> ในตาราง <code class="highlighter-rouge">Person</code> ได้</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">add_table_index</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:job</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="ss">:ok</span><span class="p">}</span>
</code></pre></div></div>

<p>ผลลัพธ์ที่ได้จะคล้ายกันกับค่าที่คืนมาจาก <code class="highlighter-rouge">Mnesia.create_table/2</code>:</p>

<ul>
  <li><code class="highlighter-rouge">{:atomic, :ok}</code> ถ้า function ทำงานสำเร็จ</li>
  <li><code class="highlighter-rouge">{:aborted, Reason}</code> ถ้า function ทำงานล้มเหลว</li>
</ul>

<p>โดยปกติแล้ว ถ้ามี index อยู่แล้ว Reason จะเป็น <code class="highlighter-rouge">{:already_exists, table, attribute_index}</code> ดังนั้นถ้าเราพยายามจะสร้าง index เป็นครั้งที่สอง เราจะได้ว่า</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">add_table_index</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:job</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:aborted</span><span class="p">,</span> <span class="p">{</span><span class="ss">:already_exists</span><span class="p">,</span> <span class="no">Person</span><span class="p">,</span> <span class="mi">4</span><span class="p">}}</span>
</code></pre></div></div>

<p>เมื่อได้สร้าง index แล้ว เราสามารถอ่านและเอา list ออกมาได้</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span>
<span class="o">...&gt;</span>   <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">index_read</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="s2">"Principal"</span><span class="p">,</span> <span class="ss">:job</span><span class="p">)</span>
<span class="o">...&gt;</span>   <span class="k">end</span>
<span class="o">...&gt;</span> <span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"Seymour Skinner"</span><span class="p">,</span> <span class="s2">"Principal"</span><span class="p">}]}</span>
</code></pre></div></div>

<h2 id="match-and-select">Match and select</h2>

<p>Mnesia รองรับการ query แบบซับซ้อน เพื่อที่จะดึงข้อมูลออกมาจากตารางในรูปของ matching และ function การเลือกแบบเฉพาะเจาะจง</p>

<p>function <code class="highlighter-rouge">Mnesia.match_object/1</code> จะคืนค่า record ทั้งหมดที่ match กับ pattern ที่กำหนดให้ ถ้ามี columnไหนในตารางมี index มันก็จะใช้ index เพื่อทำให้การ query มีประสิทธิภาพมากขึ้น ใช้ atom แบบพิเศษ <code class="highlighter-rouge">:_</code> เพื่อระบุ columnที่ไม่ต้องการใช้ในการ match</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span>
<span class="o">...&gt;</span>   <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">match_object</span><span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:_</span><span class="p">,</span> <span class="s2">"Marge Simpson"</span><span class="p">,</span> <span class="ss">:_</span><span class="p">})</span>
<span class="o">...&gt;</span>   <span class="k">end</span>
<span class="o">...&gt;</span> <span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="p">[{</span><span class="no">Person</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">"Marge Simpson"</span><span class="p">,</span> <span class="s2">"home maker"</span><span class="p">}]}</span>
</code></pre></div></div>

<p>function <code class="highlighter-rouge">Mnesia.select/2</code> อนุญาตให้ระบุ custom query โดยใช้ operator หรือ function ใดๆ ใน Elixir (หรือ Erlang ที่ใช้ได้) ลองดูตัวอย่างของการเอา row ทั้งหมดที่มี key มากกว่า 3:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">transaction</span><span class="p">(</span>
<span class="o">...&gt;</span>   <span class="k">fn</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="p">[{{</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:"$1"</span><span class="p">,</span> <span class="ss">:"$2"</span><span class="p">,</span> <span class="ss">:"$3"</span><span class="p">},</span> <span class="p">[{</span><span class="ss">:&gt;</span><span class="p">,</span> <span class="ss">:"$1"</span><span class="p">,</span> <span class="mi">3</span><span class="p">}],</span> <span class="p">[</span><span class="ss">:"$$"</span><span class="p">]}])</span>
<span class="o">...&gt;</span>   <span class="k">end</span>
<span class="o">...&gt;</span> <span class="p">)</span>
<span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="s2">"Waylon Smithers"</span><span class="p">,</span> <span class="s2">"Executive assistant"</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">"Marge Simpson"</span><span class="p">,</span> <span class="s2">"home maker"</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s2">"Monty Burns"</span><span class="p">,</span> <span class="s2">"Businessman"</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s2">"Hans Moleman"</span><span class="p">,</span> <span class="s2">"unknown"</span><span class="p">]]}</span>
</code></pre></div></div>

<p>มาแกะดูกันดีกว่า attribute แรกคือชื่อตาราง <code class="highlighter-rouge">Person</code> attribute ที่สองคือ 3 ค่าในรูปแบบของ <code class="highlighter-rouge">{match, [guard], [result]}</code>:</p>

<ul>
  <li><code class="highlighter-rouge">match</code> คือสิ่งเดียวกับที่เราส่งผ่าน function <code class="highlighter-rouge">Mnesia.match_object/1</code>; อย่างไรก็ตามจงจำไว้ว่า atom แบบพิเศษ​ <code class="highlighter-rouge">:"$n"</code> ใช้สำหรับระบุตำแหน่งของ parameter ที่จะใช้ในส่วนที่เหลือของการ query</li>
  <li><code class="highlighter-rouge">guard</code> list คือ list ของ tuple ที่ใช้ในการระบุ function guard ที่จะใช้ในการ query, ในที่นี้คือ <code class="highlighter-rouge">:&gt;</code> (มากกว่า) function แบบ built in ตามมาด้วย parameter สำหรับบอกตำแหน่ง column <code class="highlighter-rouge">:"$1"</code> และค่าคงที่ <code class="highlighter-rouge">3</code> เป็น attribute</li>
  <li><code class="highlighter-rouge">result</code> list คือ list ของ field ที่จะให้คืนออกมาจากการ query ในรูปแบบของตำแหน่ง parameter, atom แบบพิเศษ <code class="highlighter-rouge">:"$$"</code> ใช้สำหรับอ้างถึงทุก field ดังนั้นคุณอาจจะใช้ <code class="highlighter-rouge">[:"$1", :"$2"]</code> เพื่อเอาค่าของ 2 ตัวแรกใน field หรือ <code class="highlighter-rouge">[:"$$"]</code> เพื่อเอาทุกค่าก็ได้</li>
</ul>

<p>รายละเอียดเพิ่มเติม ดูที่ <a href="http://erlang.org/doc/man/mnesia.html#select-2">the Erlang Mnesia documentation for select/2</a>.</p>

<h2 id="data-initialization-and-migration">Data initialization and migration</h2>

<p>ในทุกๆ solution ของ software จะต้องมีช่วงเวลาที่จะต้อง upgrade หรือ migrate ข้อมูลที่อยู่ใน database ของคุณ ยกตัวอย่างเช่น เราอาจจะอยากเพิ่ม column <code class="highlighter-rouge">:age</code> เข้าไปในตาราง <code class="highlighter-rouge">Person</code> ใน v2 ของแอพ เราไม่สามารถสร้างตาราง <code class="highlighter-rouge">Person</code> อีกครั้งได้ แต่เราสามารถเปลี่ยนมันได้ สำหรับการเปลี่ยนรูปแบบตารางเราจะต้องรู้ว่าตอนไหนควรจะเปลี่ยน โดยเราสามารถทำได้ตอนที่เราสร้างตารางแล้ว นั่นคือการใช้ function <code class="highlighter-rouge">Mnesia.table_info/2</code> เพื่อดูโครงสร้างปัจจุบันของตารางและใช้ function <code class="highlighter-rouge">Mnesia.transform_table/3</code> เพื่อแปลงให้เป็นโครงสร้างใหม่</p>

<p>code ด้านล่างจะทำสิ่งนี้ด้วยการใช้ logic ต่อไปนี้</p>

<ul>
  <li>สร้างตารางสำหรับ attribute ใน v2: <code class="highlighter-rouge">[:id, :name, :job, :age]</code></li>
  <li>Handle ผลลัพธ์ของการสร้างตาราง
    <ul>
      <li><code class="highlighter-rouge">{:atomic, :ok}</code>: สร้างตารางเริ่มต้นโดยสร้าง index  ให้กับ <code class="highlighter-rouge">:job</code> และ <code class="highlighter-rouge">:age</code></li>
      <li><code class="highlighter-rouge">{:aborted, {:already_exists, Person}}</code>: ตรวจสอบดู attribute ของตารางปัจจุบัน และทำตามตามนี้
        <ul>
          <li>ถ้าเป็น v1 list (<code class="highlighter-rouge">[:id, :name, :job]</code>), แปลงตารางโดยให้ทุกคนมี age ที่ 21 และสร้าง index ให้ <code class="highlighter-rouge">:age</code></li>
          <li>ถ้าเป็น v2 list ไม่ต้องทำอะไร</li>
          <li>ถ้าเป็นอย่างอื่น โยนทิ้งไป</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>function <code class="highlighter-rouge">Mnesia.transform_table/3</code> เอา attribute ชื่อของตาราง, function ที่ใช้ในการแปลงตารางจากอันเก่าเป็นอันใหม่ และ list ของ attribute ใหม่</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iex</span><span class="o">&gt;</span> <span class="k">case</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="p">[</span><span class="ss">attributes:</span> <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">,</span> <span class="ss">:age</span><span class="p">]])</span> <span class="k">do</span>
<span class="o">...&gt;</span>   <span class="p">{</span><span class="ss">:atomic</span><span class="p">,</span> <span class="ss">:ok</span><span class="p">}</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">add_table_index</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:job</span><span class="p">)</span>
<span class="o">...&gt;</span>     <span class="no">Mnesia</span><span class="o">.</span><span class="n">add_table_index</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:age</span><span class="p">)</span>
<span class="o">...&gt;</span>   <span class="p">{</span><span class="ss">:aborted</span><span class="p">,</span> <span class="p">{</span><span class="ss">:already_exists</span><span class="p">,</span> <span class="no">Person</span><span class="p">}}</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>     <span class="k">case</span> <span class="no">Mnesia</span><span class="o">.</span><span class="n">table_info</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:attributes</span><span class="p">)</span> <span class="k">do</span>
<span class="o">...&gt;</span>       <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">]</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>         <span class="no">Mnesia</span><span class="o">.</span><span class="n">transform_table</span><span class="p">(</span>
<span class="o">...&gt;</span>           <span class="no">Person</span><span class="p">,</span>
<span class="o">...&gt;</span>           <span class="k">fn</span> <span class="p">({</span><span class="no">Person</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">job</span><span class="p">})</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>             <span class="p">{</span><span class="no">Person</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="mi">21</span><span class="p">}</span>
<span class="o">...&gt;</span>           <span class="k">end</span><span class="p">,</span>
<span class="o">...&gt;</span>           <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">,</span> <span class="ss">:age</span><span class="p">]</span>
<span class="o">...&gt;</span>           <span class="p">)</span>
<span class="o">...&gt;</span>         <span class="no">Mnesia</span><span class="o">.</span><span class="n">add_table_index</span><span class="p">(</span><span class="no">Person</span><span class="p">,</span> <span class="ss">:age</span><span class="p">)</span>
<span class="o">...&gt;</span>       <span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:job</span><span class="p">,</span> <span class="ss">:age</span><span class="p">]</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>         <span class="ss">:ok</span>
<span class="o">...&gt;</span>       <span class="n">other</span> <span class="o">-&gt;</span>
<span class="o">...&gt;</span>         <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="n">other</span><span class="p">}</span>
<span class="o">...&gt;</span>     <span class="k">end</span>
<span class="o">...&gt;</span> <span class="k">end</span>
</code></pre></div></div>

    
    <blockquote class="edit-lesson">    
      Caught a mistake or want to contribute to the lesson?
      <a href="https://github.com/elixirschool/elixirschool/edit/master/th/lessons/specifics/mnesia.md" target="_blank" rel="noopener">
        Edit this page on GitHub!
      </a>
    </blockquote>
  </div>
</section>



<section>

<div class="row">
    
    
    
    <div class="6u 12u$(small)">
        <a class="button special fit" href="/th/lessons/advanced/concurrency/" title="การทำงานพร้อมกัน (Concurrency)">← การทำงานพร้อมกัน (Concurrency)</a>
    </div>
    
    
</div>
</section>




				</div>
			</div>
			<!-- Sidebar -->
  <div id="sidebar">
    <p class="toggle-theme-wrapper"><a rel="noopener" href="#toggle-theme" class="toggle-theme icon fas fa-circle-o" alt="Toggle Theme" title="Toggle Theme"></a></p>

    <div class="inner">
      
<!-- Locales Section -->
<section id="search" class="alt">
  <div id="locales">

      
        
        

        
          <a href="/en/lessons/specifics/mnesia/" title="ภาษาอังกฤษ / English">en</a>
        
      
        
        

        
          <a href="/es/lessons/specifics/mnesia/" title="ภาษาสเปน / Español">es</a>
        
      
        
        

        
          <a href="/gr/lessons/specifics/mnesia/" title="ภาษากรีก">gr</a>
        
      
        
        

        
          <a href="/id/lessons/specifics/mnesia/" title="ภาษาอินโดนิเซีย / Bahasa Indonesia">id</a>
        
      
        
        

        
          <a href="/ko/lessons/specifics/mnesia/" title="ภาษาเกาหลี">ko</a>
        
      
        
        

        
          <a href="/pl/lessons/specifics/mnesia/" title="ภาษาโปแลนด์">pl</a>
        
      
        
        

        
          <a href="/pt/lessons/specifics/mnesia/" title="ภาษาโปรตุเกส">pt</a>
        
      
        
        

        
          <a href="/ru/lessons/specifics/mnesia/" title="ภาษารัสเซีย / Русский">ru</a>
        
      
        
        

        
          <strong title="ภาษาไทย">th</strong>
        
      
        
        

        
          <a href="/vi/lessons/specifics/mnesia/" title="ภาษาเวียดนาม">vi</a>
        
      
        
        

        
          <a href="/zh-hans/lessons/specifics/mnesia/" title="ภาษาจีน">zh-hans</a>
        
      
        
        

        
          <a href="/zh-hant/lessons/specifics/mnesia/" >zh-hant</a>
        
      

  </div>
</section>


      
<!-- Menu -->
<nav id="menu">
  <span class="stack-info otp-version">Elixir 1.10.1 - Erlang/OTP 22.0 [erts-10.5.3]</span>
  <header class="major">
    <h2>Menu</h2>
    <p>บทเรียนเกี่ยวกับภาษา Elixir</p>
  </header>
  <ul>
    <li>
      <a href="/th/" class=" up ">หน้าแรก</a>
    </li>
  
    
    
    
    
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">พื้นฐาน</span>
          <ul>
        
            <li>
              
              <a href="/th/lessons/basics/basics/">1. พื้นฐาน</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/collections/">2. กลุ่มข้อมูล (Collections)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/enum/">3. Enum</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/pattern-matching/">4. การจับคู่รูปแบบ (Pattern Matching)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/control-structures/">5. Control Structures</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/functions/">6. ฟังก์ชัน(Functions)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/pipe-operator/">7. Pipe Operator</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/basics/mix/">9. Mix</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">ขั้นสูง</span>
          <ul>
        
            <li>
              
              <a href="/th/lessons/advanced/erlang/">1. การใช้งานร่วมกับ Erlang</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/th/lessons/advanced/concurrency/">4. การทำงานพร้อมกัน (Concurrency)</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener active up">เฉพาะทาง</span>
          <ul>
        
            <li>
              
              <span class="active">4. Mnesia</span>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    <li>
      <a href="/blog/" class=" up ">Blog</a>
    </li>
    
    <li>
      <a href="/th/report/" class=" up ">Translation Report</a>
    </li>
    
    <li>
      <a href="/contributors/" class=" up ">Contributors</a>
    </li>
  </ul>
</nav>

      <!-- Footer -->
      <footer id="footer">
        <p class="copyright">&copy; 2021 <a target="_blank" rel="noopener" href="https://github.com/doomspork">Sean Callan</a> All rights reserved.</p>
      </footer>
    </div>
  </div>

		</div>
		<!-- Scripts -->

    <script async="" src="/assets/main-f8c201d2721dcb6d1d4f6acb0ebd2b2c192757ed29271f519513e4417e347611.js" type="text/javascript"></script>
		<!--[if lte IE 8]><script async="" src="/assets/ie/respond.min-8306093ccce666c01dab405fac0d16596a1d1cf38aa0ba919d4831261662cdbb.js" type="text/javascript"></script><script src="assets/js/ie/respond.min.js"></script><![endif]-->
	</body>
</html>

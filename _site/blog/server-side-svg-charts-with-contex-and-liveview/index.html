<!DOCTYPE HTML>



<html lang="en">
	<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta name="description" content="">
  <meta name="author" content="Sean Callan">

  <meta property="og:url" content="http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/">
  <meta property="og:site_name" content="ElixirSchool">
  <meta property="og:title" content="">
  <meta property="og:locale" content="">
  <meta property="og:description" content="">
  <meta property="og:image" content="http://localhost:4000/assets/og_image-fad975b316dea5dc361d199bdfaa076006da49a0a3296f799aa7217b4c8b0cbe.jpg">
  
  

  <link rel="canonical" href="http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/">
  <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/favicons/apple-touch-icon-06ad80501b5734bba0428ca0fc14fcbe45811a144914f7be78cdab3c3ea25458.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/favicons/favicon-32x32-6e7b9eca57d29d185a5184e844c1372ce9da0a71f373f89b80ff11f120b01678.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/favicons/favicon-16x16-789b56195138252cac40cf7f2425b6fcb4e71c3084abc8525781188781b958d3.png">
  <link rel="manifest" href="http://localhost:4000/manifest.json">
  <link rel="shortcut icon" href="http://localhost:4000/assets/favicons/favicon-8e1fdc2a44d6344b9871b3ecf53a803903891f82a602a3f59c65eda40f2b77b0.ico">
  <link rel="alternate" type="application/rss+xml" title="Elixir School" href="https://elixirschool.com/feed.xml" />
  <meta name="msapplication-config" content="http://localhost:4000/assets/favicons/browserconfig-e66282a6754e6899f9a53c6ebfe120749630242b741deb65f364abc297ccbc96.xml">
  <meta name="theme-color" content="#ffffff">

  
  
  <title>Real-Time SVG Charts with Contex and LiveView &middot; Elixir School</title>
  <!-- CSS -->
  <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" type="text/css" href="/assets/main-07a5a32c1a26652d2bb0e43b4c7ade37f20599a76cae3c1e871d3af53cff80b2.css">
  <!--[if lte IE 9]><link rel="stylesheet" type="text/css" href="/assets/ie9-0c07c3ea146a3dd5dce4effda97b3718824cab9c30149877c0e445edecfdee60.css"><![endif]-->
  <!--[if lte IE 8]><link rel="stylesheet" type="text/css" href="/assets/ie8-f0c85ce6ad95a6d33929cb969a44f41a5e96ecb22de55f55d0f3c83cfc0012fc.css"><![endif]-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
  <script type="text/javascript">
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
  analytics.load("C0p07Sw9j7mZnycKDCgPOAyqJR5hhyoQ");
  analytics.page()
  }}();
  </script>
  <script type="text/javascript">
    if ("serviceWorker" in navigator) {
      if (!navigator.serviceWorker.controller) {
        navigator.serviceWorker.register("http://localhost:4000/serviceworker.js", {
          scope: "http://localhost:4000"
        })
        .then(reg => console.log("Service worker has been registered for scope: ", reg.scope))
        .catch(error => console.log("Service worker registration has failed: ", error));
      }
    }  
  </script>
</head>

	<body class="is-loading">
    <script type="text/javascript">
    var $theme = localStorage.getItem('theme');
    if ($theme === 'dark') document.body.classList.add("dark");
    </script>
		<!-- Wrapper -->
		<div id="wrapper">
			<!-- Main -->
			<div id="main">
				<div class="inner">
					<!-- Header -->
					<header id="header">
					  <a href="/" class="logo"><strong>Elixir School</strong> Blog</a>
					  <ul class="icons">
  
  <li><iframe src="https://ghbtns.com/github-btn.html?user=elixirschool&repo=elixirschool&type=star&count=true" height="20" title="GitHub Stars" width="93" style="vertical-align: sub;"></iframe></li>
  <li><a target="_blank" rel="noopener" title="RSS" href="https://elixirschool.com/feed.xml" class="icon fa-rss-square"><span class="label">RSS</span></a></li>
  <li><a target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/&title=Real-Time SVG Charts with Contex and LiveView&summary=description&source=http://localhost:4000" class="icon fa-linkedin"><span class="label">Linkedin</span></a></li>
  <li><a target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/intent/tweet?url=http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/&via=elixirschool&text=ElixirSchool: Real-Time SVG Charts with Contex and LiveView&hashtags=learnelixir%2Celixirlang&" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
  <li><a target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
  <li><a target="_blank" rel="noopener" title="Pinterest" href="https://www.pinterest.com/pin/create/link/?url=http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/&media=http://localhost:4000/assets/og_image-fad975b316dea5dc361d199bdfaa076006da49a0a3296f799aa7217b4c8b0cbe.jpg&description=ElixirSchool: Real-Time SVG Charts with Contex and LiveView" class="icon fa-pinterest"><span class="label">Pinterest</span></a></li>
  <li><a target="_blank" rel="noopener" title="VK" href="https://vk.com/share.php?url=http://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/&title=ElixirSchool: Real-Time SVG Charts with Contex and LiveView&description=Check out 'Real-Time SVG Charts with Contex and LiveView' on ElixirSchool" class="icon fa-vk"><span class="label">VK</span></a></li>
  <li><a target="_blank" rel="noopener" title="Email" href="mailto:?to=&subject=ElixirSchool: Real-Time SVG Charts with Contex and LiveView&body=Check out 'Real-Time SVG Charts with Contex and LiveView' on ElixirSchool%0D%0A%0D%0Ahttp://localhost:4000/blog/server-side-svg-charts-with-contex-and-liveview/" class="icon fa-envelope"><span class="label">Email</span></a></li>
  <li><a title="Print" href="javascript:window.print()" class="icon fa-print"><span class="label">Print</span></a></li>
</ul>

					</header>
					

<section id="section-page">
  <header class="main">
    <h1 class="post-title">Real-Time SVG Charts with Contex and LiveView</h1>
    <p><a href="/blog/years/2020/">06 Oct 2020</a> · by 

    <a href="https://thegreatcodeadventure.com" target="_blank" rel="nofollow noopener">Sophie DeBenedetto</a> in <a href="/blog/categories/general/">General</a></p>
  </header>
  <div class="content">
    <p>This post is inspired by some of my work, together with <a href="https://twitter.com/redrapids">Bruce Tate</a>, on Pragmatic Bookshelf’s upcoming book on LiveView. Elixir School is happy to be able to offer a give-away of a small number e-books once they are published, so stay tuned for updates!</p>

<p>As LiveView matures it is becoming clear that it much more than just a tool for building real-time features in your web app. LiveView is a state management system for your single page app. Developers are increasingly reaching for LiveView to build and manage the complexities of a full-featured SPA. This is why, in our upcoming LiveView book, we’re aiming to build out a diverse and robust set of features using LiveView.</p>

<p>Once such common feature is that of a real-time admin-facing dashboard. Such dashboards often require data visualization and LiveView means we can offer data viz in real-time. In this post, we’ll look at how to leverage the <a href="https://github.com/mindok/contex">Contex</a> library for server-side SVG chart rendering. We’ll render a Contex chart in a LiveView and update our chart in real-time. Along the way, I hope you’ll get excited about what you can do with LiveView, and what you can learn if you dive into our upcoming book.</p>

<h2 id="the-problem">The Problem</h2>

<p>While there quite a few JavaScript charting libraries to choose from, we’re after a <em>server-side rendering</em> solution. LiveView manages state on the server. State changes trigger re-renders the HTML, pushes that HTML to the client, which then efficiently updates the UI. So, we don’t want to bring in a library to renders charts with lots of complex JavaScript on the client. We need to be able to draw our charts on the server and send that chart HTML down to the client.</p>

<p>While there aren’t many server-rendered chart libraries in Elixir, luckily for us, there is Contex!</p>

<h2 id="introducing-contex">Introducing Contex</h2>
<p><a href="https://github.com/mindok/contex">Contex</a> is a server-side charting library written in Elixir that allows us to build and render SVG charts on the server. We can then use LiveView to render these charts in a template and enable them to be updated in real-time. Contex currently supports bar charts, point plots, gantt charts and sparkline charts.</p>

<p>It’s worth mentioning that there are a few other server-side charting libraries in Elixir. The <a href="https://github.com/srowley/ggity"><code class="highlighter-rouge">ggity</code></a> is designed to “bring interface of R’s <code class="highlighter-rouge">ggplot2</code> library to the task of drawing SVG plots with Elixir” and supports a number of different chart types. The <a href="https://github.com/elcritch/plotex"><code class="highlighter-rouge">plotex</code></a> library builds and renders time plot series SVG charts on the server. The <code class="highlighter-rouge">ggity</code> library, while likely a good choice for exploratory data analysis, is not optimized for use with LiveView nor is it currently intended for production use and the <code class="highlighter-rouge">plotex</code> library is aimed at rendering time plot series charts only. So, <code class="highlighter-rouge">contex</code>, while still a new library with some <a href="https://github.com/mindok/contex#warning">in-progress TODOs</a>, is most closely aligned with our need to performantly render data in LiveView, in real-time, in a variety of formats.</p>

<p>In this post, we’ll focus on using Contex to build a bar chart.</p>

<h2 id="what-well-build">What We’ll Build</h2>
<p>Drawing from an example that you’ll see in greater depth in our upcoming LiveView book, we’ll add a chart to our Admin Dashboard LiveView. The Admin Dashboard is part of an online gaming app in which users can play online versions of games like ping-pong and tic-tac-toe. We ask users to fill our a survey that rates games on a scale of 1 to 5 stars. Our Admin Dashboard should include a chart of products and their average star ratings. Something like this:</p>

<p><img src="/assets/game-ratings-chart-c97d10c38c3dc7b6c9ba91d9710f8957b4de80dab0df1218942908c028bc18b6.png" alt="game ratings chart" /></p>

<p>The chart should also update in real-time. In other words, as users around the world use and review our extremely popular and super fun games, the chart should update in real-time to reflect updated average ratings.</p>

<p>For the purposes of this post, we’ll assume we already have a LiveView <code class="highlighter-rouge">GameStoreWeb.AdminDashboardLive</code>, mounted at <code class="highlighter-rouge">live '/admin-dashboard'</code>.</p>

<p>This LiveView renders a stateful child component, <code class="highlighter-rouge">GameStoreWeb.GameRatingsLive</code>. This component is where we will build and render our bar chart.</p>

<p>Taking a brief look at our <code class="highlighter-rouge">AdminDashboardLive</code> LiveView, we can see it establishes a socket assignment, <code class="highlighter-rouge">:game_ratings_component_id</code>:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/admin_dashboard_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">AdminDashboardLive</span> <span class="k">do</span>
  <span class="k">def</span> <span class="n">mount</span><span class="p">(</span><span class="n">_params</span><span class="p">,</span> <span class="n">_session</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
     <span class="n">socket</span>
     <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="ss">:game_ratings_component_id</span><span class="p">,</span> <span class="s2">"game-ratings"</span><span class="p">)}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Then, we use this assignment to set the <code class="highlighter-rouge">:id</code> of our stateful component:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/admin_dashboard_live.html.leex</span>
<span class="o">&lt;%=</span> <span class="n">live_component</span> <span class="nv">@socket</span><span class="p">,</span>
      <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span><span class="p">,</span>
      <span class="ss">id:</span> <span class="nv">@game_ratings_component_id</span> <span class="p">%</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>We’re storing the component’s ID in socket assigns so that we can use it later to send updates to the component with the help of the <code class="highlighter-rouge">send_update/2</code> function. More on that later.</p>

<h2 id="getting-started">Getting Started</h2>
<p>First off, we’ll add the Contex package to our app’s dependencies in the <code class="highlighter-rouge">mix.exs</code> file:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="ss">:contex</span><span class="p">,</span> <span class="s2">"0.3.0"</span><span class="p">}</span>
</code></pre></div></div>

<p>Run <code class="highlighter-rouge">mix deps.get</code> to install the new dependency.</p>

<h2 id="querying-data-to-chart">Querying Data To Chart</h2>
<p>Before we can render our bar chart, we need to query for and format our data for the chart. We’ll write query that selects all of the games, along with the average rating for each game.</p>

<p>We’ll implement our query in a query builder module defined in the core of application. The functional core of our application is where we put all of the code that is predictable and reliable. Working with the data in our database is a great example of something that is just that. Let’s take a look at our query  now.</p>

<p>In our data model, we games that have many ratings. So, we’ll query for games, joined on the ratings table, and select the game name and a computed average of all of the given game’s ratings’ stars.</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/catalogue/game/query.ex</span>
<span class="k">defmodule</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span><span class="o">.</span><span class="no">Game</span><span class="o">.</span><span class="no">Query</span> <span class="k">do</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Survey</span><span class="o">.</span><span class="no">Rating</span>

  <span class="k">def</span> <span class="n">base</span> <span class="k">do</span>
    <span class="no">Game</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">with_average_ratings</span><span class="p">(</span><span class="n">query</span> <span class="p">\\</span> <span class="n">base</span><span class="p">())</span> <span class="k">do</span>
    <span class="n">query</span>
    <span class="o">|&gt;</span> <span class="n">join_ratings</span>
    <span class="o">|&gt;</span> <span class="n">average_ratings</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">join_ratings</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">query</span>
    <span class="o">|&gt;</span> <span class="n">join</span><span class="p">(</span><span class="ss">:inner</span><span class="p">,</span> <span class="p">[</span><span class="n">g</span><span class="p">],</span> <span class="n">r</span> <span class="ow">in</span> <span class="no">Rating</span><span class="p">,</span> <span class="ss">on:</span> <span class="n">r</span><span class="o">.</span><span class="n">game_id</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">average_ratings</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">query</span>
    <span class="o">|&gt;</span> <span class="n">group_by</span><span class="p">([</span><span class="n">g</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="n">select</span><span class="p">([</span><span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">],</span> <span class="p">{</span><span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fragment</span><span class="p">(</span><span class="s2">"?::float"</span><span class="p">,</span> <span class="n">avg</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">stars</span><span class="p">))})</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>
<p>While the work of <em>composing</em> queries is predictable and reliable, the work of <em>executing</em> queries is anything but. You can’t be certain of what the results of executing a database query will be, and such work is often dependent on input from a user. So, the execution of our query will be the responsibility of our app’s <code class="highlighter-rouge">Catalogue</code> context. The context acts as our application’s boundary, and it’s where we can located code that deals with uncertainty and with input from the outside world.</p>

<p>Let’s wrap up our query in a context function in the <code class="highlighter-rouge">Catalogue</code> context now. We execute our query by piping it to a call to <code class="highlighter-rouge">Repo.all()</code></p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/catalogue.ex</span>
<span class="k">defmodule</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span> <span class="k">do</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span><span class="o">.</span><span class="no">Game</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Repo</span>

  <span class="k">def</span> <span class="n">games_with_average_ratings</span> <span class="k">do</span>
    <span class="no">Game</span><span class="o">.</span><span class="no">Query</span><span class="o">.</span><span class="n">with_average_ratings</span>
    <span class="o">|&gt;</span> <span class="no">Repo</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Let’s take a look at the results of executing this query now:</p>

<pre><code class="language-iex">iex&gt; alias GameStore.Repo
iex(4)&gt; Catalogue.games_with_average_ratings()
[debug] QUERY OK source="games" db=6.1ms decode=2.1ms queue=7.1ms idle=1495.6ms
SELECT g0."name", avg(r1."stars")::float FROM "games" AS g0 INNER JOIN "ratings" AS r1 ON r1."game_id" = g0."id" GROUP BY g0."id" []
[
  {"Tic-Tac-Toe", 3.4285714285714284},
  {"Ping Pong", 2.5714285714285716},
  {"Pictionary", 2.625}
]
</code></pre>

<p>Note that we’ve chosen for our query to select and return a collection of results, each of which is a tuple with two elements. The first element is the name of the game and the second element is the average rating. This format is purposeful, designed for use in our Contex bar chart.</p>

<p>Let’s turn our attention to building out that chart with this data now.</p>

<h2 id="defining-your-chart-in-liveview">Defining Your Chart in LiveView</h2>
<p>Before we build out or component in earnest, it’s worth mentioning the pattern that we will be applying to manage state in that component. We’ll rely on reducers to successively update socket state to initialize the starting state of our component and handle updates. Reducers are functions that take a thing and return an updated thing of the same type. They allow us to compose neat, clean pipelines that make it easy to build and manage LiveView state and respond to events by updating that state. This is a pattern that we’ll go into greater depth on in our LiveView book.</p>

<h3 id="storing-chart-data-in-state">Storing Chart Data in State</h3>
<p>First off, we’ll teach our <code class="highlighter-rouge">GameRatingsLive</code> component to query for these games with average ratings and keep them in the socket assigns.</p>

<p>Recall that earlier we said that we’re rendering the <code class="highlighter-rouge">GameRatingsLive</code> component as a stateful component in the <code class="highlighter-rouge">AdminDashboardLive</code> LiveView. We’ll leverage the stateful component’s <code class="highlighter-rouge">update/2</code> lifecycle method to fetch our game and ratings data and store it in socket assigns.</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">GameStoreWeb</span><span class="p">,</span> <span class="ss">:live_component</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span>

  <span class="k">def</span> <span class="n">update</span><span class="p">(</span><span class="n">assigns</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
     <span class="n">socket</span>
     <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span>
     <span class="o">|&gt;</span> <span class="n">assign_games_with_average_ratings</span><span class="p">()}</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">assign_games_with_average_ratings</span><span class="p">(</span><span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">socket</span>
    <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="ss">:games_with_average_ratings</span><span class="p">,</span> <span class="no">Catalogue</span><span class="o">.</span><span class="n">games_with_average_ratings</span><span class="p">())</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Note that we’re piping our socket through a set of reducers, each of which further decorate the socket state. These reducer functions take in an argument of the socket, do something to that socket, and return a new socket with the updated state.</p>

<p>First, we’ll apply whatever assigns have come in from the parent LiveView, then we’ll add a key of <code class="highlighter-rouge">:games_with_average_ratings</code> to assigns, pointing to a value of our query results.</p>

<p>Now that we have our query results available in state, we’re ready to use them to build our chart.</p>

<h3 id="building-the-bar-chart">Building The Bar Chart</h3>
<p>There are three stages to building a Contex chart:</p>

<ul>
  <li>Initializing the dataset</li>
  <li>Initializing the chart</li>
  <li>Rendering the chart to SVG</li>
</ul>

<p>We’ll add a reducer to our <code class="highlighter-rouge">update/2</code> pipeline that updates socket state for each step in this process.</p>

<h4 id="initializing-the-dataset">Initializing the <code class="highlighter-rouge">DataSet</code></h4>
<p>The first step of building a Contex chart is to initialize the data set with the <code class="highlighter-rouge">Contex.DataSet</code> module. <a href="https://hexdocs.pm/contex/Contex.Dataset.html">The <code class="highlighter-rouge">DataSet</code> module</a> wraps your dataset for plotting charts. It provides a set of convenience functions that subsequent chart plotting modules will leverage to operate on and chart your data. <code class="highlighter-rouge">Dataset</code> handles several different data structures by marshalling them into a consistent form for consumption by the chart plotting functions. The data structures it can handle are: a list of maps, list of lists or a list of tuples. Recall that we ensured that our query for games with average ratings returns a list of tuples.</p>

<p>We’ll begin by implementing a new reducer function, <code class="highlighter-rouge">assign_dataset/1</code>. This reducer will initialize a new <code class="highlighter-rouge">DataSet</code> with the query results, our list of game and average rating tuples, from socket assigns. Then, it will add the dataset to socket state:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">GameStoreWeb</span><span class="p">,</span> <span class="ss">:live_component</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span>

  <span class="k">def</span> <span class="n">update</span><span class="p">(</span><span class="n">assigns</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
     <span class="n">socket</span>
     <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span>
     <span class="o">|&gt;</span> <span class="n">assign_games_with_average_ratings</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_dataset</span><span class="p">()}</span>
  <span class="k">end</span>

  <span class="c1"># ...</span>

  <span class="k">defp</span> <span class="n">assign_dataset</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">games_with_average_ratings:</span> <span class="n">games_with_average_ratings</span><span class="p">}})</span> <span class="k">do</span>
    <span class="n">socket</span>
    <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="ss">:dataset</span><span class="p">,</span> <span class="no">Contex</span><span class="o">.</span><span class="no">Dataset</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">games_with_average_ratings</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If we take a look at the output of our call to <code class="highlighter-rouge">Contex.DataSet.new/1</code>, we’ll see the following struct:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">Dataset</span><span class="p">{</span>
  <span class="ss">data:</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">"Tic-Tac-Toe"</span><span class="p">,</span> <span class="mf">3.4285714285714284</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"Ping Pong"</span><span class="p">,</span> <span class="mf">2.5714285714285716</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">"Pictionary"</span><span class="p">,</span> <span class="mf">2.625</span><span class="p">}</span>
  <span class="p">],</span>
  <span class="ss">headers:</span> <span class="no">nil</span><span class="p">,</span>
  <span class="ss">title:</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">DataSet</code> considers the first element of a given tuple in the list to be the “category column” and the second element to be the “value column”. The category column is used to label the bar chart category (in our case the game name), and the value column is used to populate the value of that category.</p>

<h4 id="initializing-the-barchart">Initializing the <code class="highlighter-rouge">BarChart</code></h4>
<p>Now that we have our dataset, we can use it to initialize our <code class="highlighter-rouge">BarChart</code>. We’ll do this in a subsequent reducer that we’ll add to the <code class="highlighter-rouge">update/2</code> pipeline, <code class="highlighter-rouge">assign_chart/1</code>.</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">GameStoreWeb</span><span class="p">,</span> <span class="ss">:live_component</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span>

  <span class="k">def</span> <span class="n">update</span><span class="p">(</span><span class="n">assigns</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
     <span class="n">socket</span>
     <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span>
     <span class="o">|&gt;</span> <span class="n">assign_games_with_average_ratings</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_dataset</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_chart</span><span class="p">()}</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">assign_chart</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">dataset:</span> <span class="n">dataset</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">socket</span>
    <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="ss">:chart</span><span class="p">,</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The call to <code class="highlighter-rouge">BarChart.new/1</code> will create a <code class="highlighter-rouge">BarChart</code> struct that describes how to plot the bar chart. Let’s take a look at this struct now:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="p">{</span>
  <span class="ss">axis_label_rotation:</span> <span class="ss">:auto</span><span class="p">,</span>
  <span class="ss">category_scale:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">OrdinalScale</span><span class="p">{</span>
    <span class="ss">domain:</span> <span class="p">[</span><span class="s2">"Tic-Tac-Toe"</span><span class="p">,</span> <span class="s2">"Ping Pong"</span><span class="p">,</span> <span class="s2">"Pictionary"</span><span class="p">],</span>
    <span class="ss">domain_to_range_band_fn:</span> <span class="c1">#Function&lt;2.33130404/1 in Contex.OrdinalScale.update_transform_funcs/1&gt;,</span>
    <span class="ss">domain_to_range_fn:</span> <span class="c1">#Function&lt;1.33130404/1 in Contex.OrdinalScale.update_transform_funcs/1&gt;,</span>
    <span class="ss">padding:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="ss">range:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">},</span>
    <span class="ss">range_to_domain_fn:</span> <span class="c1">#Function&lt;4.33130404/1 in Contex.OrdinalScale.update_transform_funcs/1&gt;</span>
  <span class="p">},</span>
  <span class="ss">colour_palette:</span> <span class="ss">:default</span><span class="p">,</span>
  <span class="ss">custom_value_formatter:</span> <span class="no">nil</span><span class="p">,</span>
  <span class="ss">data_labels:</span> <span class="no">true</span><span class="p">,</span>
  <span class="ss">dataset:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">Dataset</span><span class="p">{</span>
    <span class="ss">data:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s2">"Tic-Tac-Toe"</span><span class="p">,</span> <span class="mf">3.4285714285714284</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">"Ping Pong"</span><span class="p">,</span> <span class="mf">2.5714285714285716</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">"Pictionary"</span><span class="p">,</span> <span class="mf">2.625</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="ss">headers:</span> <span class="no">nil</span><span class="p">,</span>
    <span class="ss">title:</span> <span class="no">nil</span>
  <span class="p">},</span>
  <span class="ss">height:</span> <span class="mi">100</span><span class="p">,</span>
  <span class="ss">mapping:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">Mapping</span><span class="p">{</span>
    <span class="ss">accessors:</span> <span class="p">%{</span>
      <span class="ss">category_col:</span> <span class="c1">#Function&lt;11.109991709/1 in Contex.Dataset.value_fn/2&gt;,</span>
      <span class="ss">value_cols:</span> <span class="p">[</span><span class="c1">#Function&lt;11.109991709/1 in Contex.Dataset.value_fn/2&gt;]</span>
    <span class="p">},</span>
    <span class="ss">column_map:</span> <span class="p">%{</span><span class="ss">category_col:</span> <span class="mi">0</span><span class="p">,</span> <span class="ss">value_cols:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
    <span class="ss">dataset:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">Dataset</span><span class="p">{</span>
      <span class="ss">data:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">"Tic-Tac-Toe"</span><span class="p">,</span> <span class="mf">3.4285714285714284</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"Ping Pong"</span><span class="p">,</span> <span class="mf">2.5714285714285716</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"Pictionary"</span><span class="p">,</span> <span class="mf">2.625</span><span class="p">}</span>
      <span class="p">],</span>
      <span class="ss">headers:</span> <span class="no">nil</span><span class="p">,</span>
      <span class="ss">title:</span> <span class="no">nil</span>
    <span class="p">},</span>
    <span class="ss">expected_mappings:</span> <span class="p">[</span><span class="ss">category_col:</span> <span class="ss">:exactly_one</span><span class="p">,</span> <span class="ss">value_cols:</span> <span class="ss">:one_or_more</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="ss">options:</span> <span class="p">[</span><span class="ss">orientation:</span> <span class="ss">:vertical</span><span class="p">],</span>
  <span class="ss">orientation:</span> <span class="ss">:vertical</span><span class="p">,</span>
  <span class="ss">padding:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="ss">phx_event_handler:</span> <span class="no">nil</span><span class="p">,</span>
  <span class="ss">select_item:</span> <span class="no">nil</span><span class="p">,</span>
  <span class="ss">series_fill_colours:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">CategoryColourScale</span><span class="p">{</span>
    <span class="ss">colour_map:</span> <span class="p">%{</span><span class="mi">1</span> <span class="o">=&gt;</span> <span class="s2">"1f77b4"</span><span class="p">},</span>
    <span class="ss">colour_palette:</span> <span class="p">[</span><span class="s2">"1f77b4"</span><span class="p">,</span> <span class="s2">"ff7f0e"</span><span class="p">,</span> <span class="s2">"2ca02c"</span><span class="p">,</span> <span class="s2">"d62728"</span><span class="p">,</span> <span class="s2">"9467bd"</span><span class="p">,</span> <span class="s2">"8c564b"</span><span class="p">,</span>
     <span class="s2">"e377c2"</span><span class="p">,</span> <span class="s2">"7f7f7f"</span><span class="p">,</span> <span class="s2">"bcbd22"</span><span class="p">,</span> <span class="s2">"17becf"</span><span class="p">],</span>
    <span class="ss">default_colour:</span> <span class="no">nil</span><span class="p">,</span>
    <span class="ss">values:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="ss">type:</span> <span class="ss">:stacked</span><span class="p">,</span>
  <span class="ss">value_range:</span> <span class="no">nil</span><span class="p">,</span>
  <span class="ss">value_scale:</span> <span class="p">%</span><span class="no">Contex</span><span class="o">.</span><span class="no">ContinuousLinearScale</span><span class="p">{</span>
    <span class="ss">custom_tick_formatter:</span> <span class="no">nil</span><span class="p">,</span>
    <span class="ss">display_decimals:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="ss">domain:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.4285714285714284</span><span class="p">},</span>
    <span class="ss">interval_count:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="ss">interval_size:</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="ss">nice_domain:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">},</span>
    <span class="ss">range:</span> <span class="p">{</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
  <span class="p">},</span>
  <span class="ss">width:</span> <span class="mi">100</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">BarChart</code> has a number of configurable options with defaults, all of which are listed in the documentation <a href="https://hexdocs.pm/contex/Contex.BarChart.html#summary">here</a>. For example, we can set the orientation (which defaults to vertical), the colors, the padding and more.</p>

<p>We can leverage the exposed configuration functions to update these defaults. Let’s take a look at how we can manipulate the color of our chart:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defp</span> <span class="n">assign_chart</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">dataset:</span> <span class="n">dataset</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">socket</span>
  <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span>
    <span class="ss">:chart</span><span class="p">,</span>
    <span class="n">dataset</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">colours</span><span class="p">(</span><span class="ss">:warm</span><span class="p">))</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will cause our chart to render with the “warm” color scheme.</p>

<p>It’s important to note again that the first column of the dataset is used as the category column (i.e. the bar), and the second column is used as the value column (i.e. the bar height). This is managed through the <code class="highlighter-rouge">:column_map</code> attribute. We can see our <code class="highlighter-rouge">BarChart</code> struct has the following <code class="highlighter-rouge">:column_map</code> value:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">column_map:</span> <span class="p">%{</span><span class="ss">category_col:</span> <span class="mi">0</span><span class="p">,</span> <span class="ss">value_cols:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
</code></pre></div></div>

<p>The values of <code class="highlighter-rouge">0</code> and <code class="highlighter-rouge">[1]</code> refer to the indices of elements in the tuples in our <code class="highlighter-rouge">DataSet</code>. The element at the <code class="highlighter-rouge">0</code> index will be considered the “category” and the element and the <code class="highlighter-rouge">1</code> index will be considered the “value”. Our tuples have the game name at the zero index and the average rating at the <code class="highlighter-rouge">1</code> index, so our game names will be treated at the category and their average ratings the value.</p>

<h4 id="render-the-chart-svg">Render the Chart SVG</h4>
<p>THe <code class="highlighter-rouge">Contex.Plot</code> module will plot our data and render it to SVG markup. We’ll add another reducer to our pipeline, <code class="highlighter-rouge">assign_chart_svg</code>. This reducer will initialize and configure the <code class="highlighter-rouge">Contex.Plot</code> and render it to SVG. Then, it will assign this SVG to the <code class="highlighter-rouge">:chart_svg</code> key in socket assigns.</p>

<p>The <code class="highlighter-rouge">Plot</code> module manages the layout of the chart plot–the chart title, axis labels, legend, etc. We initialize our <code class="highlighter-rouge">Plot</code> with the plot width and height, and the chart struct:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">GameStoreWeb</span><span class="p">,</span> <span class="ss">:live_component</span>
  <span class="n">alias</span> <span class="no">GameStore</span><span class="o">.</span><span class="no">Catalogue</span>

  <span class="k">def</span> <span class="n">update</span><span class="p">(</span><span class="n">assigns</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
     <span class="n">socket</span>
     <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span><span class="n">assigns</span><span class="p">)</span>
     <span class="o">|&gt;</span> <span class="n">assign_games_with_average_ratings</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_dataset</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_chart</span><span class="p">()</span>
     <span class="o">|&gt;</span> <span class="n">assign_chart_svg</span><span class="p">()}</span>
  <span class="k">end</span>

  <span class="k">defp</span> <span class="n">assign_chart_svg</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">chart:</span> <span class="n">chart</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">Plot</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>We’ll customize our plot with a chart table and some labels for the x- and y-axis:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defp</span> <span class="n">assign_chart_svg</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">chart:</span> <span class="n">chart</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">Plot</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
  <span class="o">|&gt;</span> <span class="no">Plot</span><span class="o">.</span><span class="n">titles</span><span class="p">(</span><span class="s2">"Game Ratings"</span><span class="p">,</span> <span class="s2">"average stars per game"</span><span class="p">)</span>
  <span class="o">|&gt;</span> <span class="no">Plot</span><span class="o">.</span><span class="n">axis_labels</span><span class="p">(</span><span class="s2">"games"</span><span class="p">,</span> <span class="s2">"stars"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will (you guessed it), apply the title, subtitles and axis labels to our chart.</p>

<p>Now we’re ready to transform our plot into an SVG with the help of the <code class="highlighter-rouge">Plot</code> module’s <code class="highlighter-rouge">to_svg/1</code> function. We’ll also be sure to add the generated SVG to socket assigns:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">defp</span> <span class="n">assign_chart_svg</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">chart:</span> <span class="n">chart</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">socket</span>
  <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span>
    <span class="ss">:chart_svg</span><span class="p">,</span>
    <span class="no">Plot</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="no">Plot</span><span class="o">.</span><span class="n">titles</span><span class="p">(</span><span class="s2">"Game Ratings"</span><span class="p">,</span> <span class="s2">"average stars per game"</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="no">Plot</span><span class="o">.</span><span class="n">axis_labels</span><span class="p">(</span><span class="s2">"games"</span><span class="p">,</span> <span class="s2">"stars"</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="no">Plot</span><span class="o">.</span><span class="n">to_svg</span><span class="p">())</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now we’re ready to render this SVG markup in our template.</p>

<h4 id="rendering-the-chart-in-the-template">Rendering the Chart in the Template</h4>
<p>Our <code class="highlighter-rouge">GameRatingsLive</code> template is pretty simple, it renders the SVG stored in the <code class="highlighter-rouge">@chart_svg</code> assignment:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- lib/game_store_web/live/game_ratings_live.html.leex --&gt;</span>
<span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;</span><span class="err">%=</span> <span class="err">@</span><span class="na">chart_svg</span> <span class="err">%</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Now, we should see the following chart rendered when we navigate to <code class="highlighter-rouge">/admin-dashboard</code>:</p>

<p><img src="/assets/game-ratings-chart-c97d10c38c3dc7b6c9ba91d9710f8957b4de80dab0df1218942908c028bc18b6.png" alt="game ratings chart" /></p>

<p>One “gotcha” that I’ll point out is that, in order to get the column labels (i.e. game names and star values) to be visible, I had to apply the custom CSS borrowed from the Contex example app <a href="https://github.com/mindok/contex-samples/blob/master/assets/css/app.css#L6-L52">here</a>, and copied below:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nc">.exc-tick</span> <span class="p">{</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="n">grey</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-tick</span> <span class="nt">text</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="n">grey</span><span class="p">;</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-grid</span> <span class="p">{</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="no">lightgrey</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-legend</span> <span class="p">{</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-legend</span> <span class="nt">text</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="n">grey</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.8rem</span><span class="p">;</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-title</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="no">darkslategray</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">2.3rem</span><span class="p">;</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.exc-subtitle</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="n">darkgrey</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.0rem</span><span class="p">;</span>
  <span class="py">stroke</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-domain</span> <span class="p">{</span>
  <span class="py">stroke</span><span class="p">:</span>  <span class="nb">rgb</span><span class="p">(</span><span class="m">207</span><span class="p">,</span> <span class="m">207</span><span class="p">,</span> <span class="m">207</span><span class="p">);</span>
<span class="p">}</span>

<span class="nc">.exc-barlabel-in</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.7rem</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.exc-barlabel-out</span> <span class="p">{</span>
  <span class="py">fill</span><span class="p">:</span> <span class="n">grey</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.7rem</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now that our chart is rendering beautifully, let’s talk about updating it in real-time.</p>

<h2 id="real-time-updates">Real-Time Updates</h2>
<p>The great news about rendering our chart in a LiveView is that we’ll get real-time updates for free! Should any state changes occur server-side, the chart will be automatically re-rendered with any new data. We could imagine, for example, leveraging PubSub to send a message to the parent <code class="highlighter-rouge">AdminDashboardLive</code> every time a user submits a new game rating. The <code class="highlighter-rouge">AdminDashboard</code> could then in turn use the <code class="highlighter-rouge">send_update/2</code> function to update the child <code class="highlighter-rouge">GameRatingsLive</code> component, causing it to re-render and re-fetch the games with average ratings data from the database, thus rendering an updated chart with the latest game ratings. In this way, LiveView can manage the state of our single page in a way that reflects and is impacted by the overall state of our distributed application. Working with PubSub and LiveView is a little outside the scope of this post, but you can learn more about it in our earlier post on this topic <a href="https://elixirschool.com/blog/live-view-with-pub-sub/">here</a>.</p>

<p>Aside from the free live updates our chart will benefit from, just by virtue of being rendered in LiveView, the Contex library does allow us to add event handlers to the chart itself. The <code class="highlighter-rouge">BarChart</code> module exposes a function, <a href="https://hexdocs.pm/contex/Contex.BarChart.html#event_handler/2"><code class="highlighter-rouge">event_handler/2</code></a>, which attaches a <code class="highlighter-rouge">phx-click</code> attribute to each bar element in the chart.</p>

<p>We’ll use this function to implement the following functionality:</p>

<blockquote>
  <p>When a user clicks a given bar in our chart,
Then that bar is highlighted</p>
</blockquote>

<p>Something like this:</p>

<p><img src="/assets/game-ratings-bar-chart-selected-206c41ec90ed935dbde4ce64b2bc74fcc415c364d9c04ad48663a3939c94bd3f.png" alt="game ratings chart selected category" /></p>

<p>We’ll being by using the <code class="highlighter-rouge">BarChart.event_handler/2</code> function to add a <code class="highlighter-rouge">phx-click</code> event to the bars in our chart.</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defp</span> <span class="n">assign_chart</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">dataset:</span> <span class="n">dataset</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">socket</span>
  <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span>
    <span class="ss">:chart</span><span class="p">,</span>
    <span class="n">dataset</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">colours</span><span class="p">(</span><span class="ss">:warm</span><span class="p">))</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">event_handler</span><span class="p">(</span><span class="s2">"chart-bar-clicked"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now let’s see what happens when we click a given bar in our chart and check our server logs:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">error</span><span class="p">]</span> <span class="no">GenServer</span> <span class="c1">#PID&lt;0.617.0&gt; terminating</span>
<span class="o">**</span> <span class="p">(</span><span class="no">UndefinedFunctionError</span><span class="p">)</span> <span class="n">function</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">AdminDashboardLive</span><span class="o">.</span><span class="n">handle_event</span><span class="o">/</span><span class="mi">3</span> <span class="n">is</span> <span class="n">undefined</span> <span class="ow">or</span> <span class="n">private</span>
<span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">AdminDashboardLive</span><span class="o">.</span><span class="n">handle_event</span><span class="p">(</span><span class="s2">"chart-bar-clicked"</span><span class="p">,</span> <span class="p">%{</span><span class="s2">"category"</span> <span class="o">=&gt;</span> <span class="s2">"Tic-Tac-Toe"</span><span class="p">,</span> <span class="s2">"series"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span> <span class="s2">"value"</span> <span class="o">=&gt;</span> <span class="s2">"3.4285714285714284"</span><span class="p">},</span> <span class="c1">#Phoenix.LiveView.Socket&lt;assigns: %{flash: %{}, live_action: :index, live_module: GameStoreWeb.AdminDashboardLive, survey_results_component_id: "survey-results"}, changed: %{}, endpoint: GameStoreWeb.Endpoint, id: "phx-FjuQogS0osBJcgnD", parent_pid: nil, root_pid: #PID&lt;0.617.0&gt;, router: GameStoreWeb.Router, view: GameStoreWeb.AdminDashboardLive, ...&gt;)</span>
</code></pre></div></div>

<p>Oh no! Our parent LiveView crashed because we haven’t yet implemented the <code class="highlighter-rouge">handle_event/3</code> function for our <code class="highlighter-rouge">"chart-bar-clicked"</code> event. You’ll notice that the event was sent to the parent LiveView, <code class="highlighter-rouge">GameStoreWeb.AdminDashboardLive</code>, and <em>not</em> our <code class="highlighter-rouge">GameRatingsLive</code> component. This is because, in order to send an event to a component, rather than it’s parent, it is necessary to add the <code class="highlighter-rouge">phx-target=&lt;%= @myself %&gt;</code> attribute to the element that contains the <code class="highlighter-rouge">phx-click</code> event (or other DOM element binding). The <code class="highlighter-rouge">@myself</code> assignment refers to the unique identifier for the current component.</p>

<p>However, the Contex package doesn’t (yet) allow us to specify the event target via the call to <code class="highlighter-rouge">BarChart.event_handler/2</code>. There is an <a href="https://github.com/mindok/contex/issues/29">open issue</a> for just this work if there are any readers out there interesetd in contributing!</p>

<p>So, we’ll need to:</p>

<ul>
  <li>Implement the <code class="highlighter-rouge">handle_event/3</code> function in the parent LiveView, <code class="highlighter-rouge">AdminDashboardLive</code></li>
  <li>Get the parent LiveView to send an update to the child component when it receives this event</li>
  <li>Teach the child component, <code class="highlighter-rouge">GameRatingsLive</code>, to render the SVG chart with a “category selection”</li>
</ul>

<p>Let’s do it!</p>

<p>We’ll start with our <code class="highlighter-rouge">handle_event/3</code> function. The function will pattern match the <code class="highlighter-rouge">"chart-bar-clicked"</code> event name and use the <code class="highlighter-rouge">send_update/2</code> function to tell the <code class="highlighter-rouge">GameRatingsLive</code> component to re-render:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/admin_dashboard_live.ex</span>
<span class="k">defmodule</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">AdminDashboardLive</span> <span class="k">do</span>
  <span class="n">alias</span> <span class="no">GameStoreWeb</span><span class="o">.</span><span class="no">GameRatingsLive</span>
  <span class="k">def</span> <span class="n">handle_event</span><span class="p">(</span><span class="s2">"chart-bar-clicked"</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send_update</span><span class="p">(</span>
      <span class="no">GameRatingsLive</span><span class="p">,</span>
      <span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="o">.</span><span class="n">game_ratings_component_id</span><span class="p">,</span>
      <span class="ss">selected_category:</span> <span class="n">payload</span><span class="p">)</span>

    <span class="p">{</span><span class="ss">:noreply</span><span class="p">,</span> <span class="n">socket</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">send_update/2</code> is called with the name of the component that we want to update and a keyword list that will get passed to the updating component as the new assigns. The keyword list <em>must</em> include the ID that we are targeting for an update. Here, we’re pulling the component’s ID out of socket assigns where we stored it in the first part of this blog post.</p>

<p>With this call to <code class="highlighter-rouge">send_update/2</code>, we will cause the <code class="highlighter-rouge">GameRatingsLive</code> component to re-render and re-invoke the <code class="highlighter-rouge">update/2</code> callback, this time with an <code class="highlighter-rouge">assigns</code> that includes our <code class="highlighter-rouge">:selected_category</code> key pointing to the click event payload. We’ll cover the <code class="highlighter-rouge">send_update/2</code> function, and more options for communicating between child components and parent LiveViews, in the LiveView book. For now, its enough to understand that <code class="highlighter-rouge">send_update/2</code> can be invoked from a parent LiveView to tell a component that is running in the LiveView to update.</p>

<p>Now we’re ready to teach the <code class="highlighter-rouge">GameRatingsLive</code> component how to render a Contex <code class="highlighter-rouge">BarChart</code> with a selected category. We can do this with the help of the <a href="https://hexdocs.pm/contex/Contex.BarChart.html#select_item/2"><code class="highlighter-rouge">BarChart.select_item/2</code></a>. This function takes in two arguments, the current <code class="highlighter-rouge">BarChart</code> struct and a map that looks like this:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">%{</span><span class="ss">category:</span> <span class="n">category</span><span class="p">,</span> <span class="ss">series:</span> <span class="n">series</span><span class="p">}</span>
</code></pre></div></div>

<p>Luckily, this is just the data that was sent through in our click event payload and that is now available in assigns under the <code class="highlighter-rouge">:selected_category</code> key!</p>

<p>Let’s update our component’s <code class="highlighter-rouge">assign_chart/1</code> function to use the <code class="highlighter-rouge">:selected_category</code> info from assigns, if it is present, and apply it to the bar chart:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib/game_store_web/live/game_ratings_live.ex</span>
<span class="k">defp</span> <span class="n">assign_chart</span><span class="p">(%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">dataset:</span> <span class="n">dataset</span><span class="p">}}</span> <span class="o">=</span> <span class="n">socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">socket</span>
  <span class="o">|&gt;</span> <span class="n">assign</span><span class="p">(</span>
    <span class="ss">:chart</span><span class="p">,</span>
    <span class="n">dataset</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">colours</span><span class="p">(</span><span class="ss">:warm</span><span class="p">))</span>
    <span class="o">|&gt;</span> <span class="no">Contex</span><span class="o">.</span><span class="no">BarChart</span><span class="o">.</span><span class="n">event_handler</span><span class="p">(</span><span class="s2">"chart-bar-clicked"</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="n">maybe_select_category</span><span class="p">()</span>
<span class="k">end</span>

<span class="k">defp</span> <span class="n">maybe_select_category</span><span class="p">(</span>
      <span class="n">chart</span><span class="p">,</span>
      <span class="p">%{</span><span class="ss">assigns:</span> <span class="p">%{</span><span class="ss">selected_category:</span> <span class="p">%{</span><span class="s2">"category"</span> <span class="o">=&gt;</span> <span class="n">category</span><span class="p">,</span> <span class="s2">"series"</span> <span class="o">=&gt;</span> <span class="n">series</span><span class="p">}}}</span> <span class="o">=</span> <span class="n">socket</span>
    <span class="p">)</span> <span class="k">do</span>
  <span class="n">chart</span>
  <span class="o">|&gt;</span> <span class="no">BarChart</span><span class="o">.</span><span class="n">select_item</span><span class="p">(%{</span><span class="ss">category:</span> <span class="n">category</span><span class="p">,</span> <span class="ss">series:</span> <span class="no">String</span><span class="o">.</span><span class="n">to_integer</span><span class="p">(</span><span class="n">series</span><span class="p">)})</span>
<span class="k">end</span>

<span class="k">defp</span> <span class="n">maybe_select_category</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">_socket</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">chart</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Here we’re adding a conditional reducer <code class="highlighter-rouge">maybe_select_category/2</code>, to our chart creation pipeline. If it is called with a socket that contains the <code class="highlighter-rouge">:selected_category</code> assignment (as would be the case if the component is updating courtesy of the parent receiving the click event), then it will apply the selected category values to the <code class="highlighter-rouge">BarChart.select_item/2</code> function. Otherwise, it will simply return the un-changed chart.</p>

<p>Now, if we point our browser at <code class="highlighter-rouge">/admin-dashboard</code> and click a given bar chart category bar, we should see it highlighted appropriately!</p>

<h2 id="conclusion">Conclusion</h2>
<p>We can see that Contex is a powerful and flexible tool for server-side SVG charting in Elixir. On top of that, it seamlessly integrates into our LiveView, accommodating real-time updates and even allowing us to attach <code class="highlighter-rouge">phx-click</code> events to chart elements. I hope to see the Contex library grow even further and encourage anyone reading to try it our and consider contributing.</p>

<p>Beyond our look at Contex, we touched on a lot of LiveView concepts here. We took a look at how core/boundary application design comes into play in our LiveView features, we leveraged stateful components and saw how parent LiveViews can communicate to their child components and we wrote some nice, organized LiveView code that leveraged reducers to establish socket state. For a deeper dive into these concepts and more, don’t forget to check out Pragmatic Bookshelf’s upcoming LiveView book, and keep an eye out for Elixir School’s LiveView book give-away!</p>

<h2 id="resources">Resources</h2>
<p>For a closer look at Contex:</p>

<ul>
  <li><a href="https://contex-charts.org/">Contex official site</a></li>
  <li><a href="https://github.com/mindok/contex-samples">Contex sample app</a></li>
</ul>

    

    <blockquote class="edit-lesson">
      Caught a mistake or want to contribute to the article?
      <a href="https://github.com/elixirschool/elixirschool/edit/master/_posts/2020-10-06-server-side-svg-charts-with-contex-and-liveview.md" target="_blank" rel="noopener">
        Edit this page on GitHub!
      </a>
    </blockquote>
  </div>
</section>
<section class="section-prevnext">
  <div class="row">
    <div class="6u 12u$(small)">
      
        <h4 class="title is-7 has-text-grey-light">Previous article</h4>
        <a class="button special fit" href="http://localhost:4000/blog/instrumenting-phoenix-with-telemetry-part-four/" title="Instrumenting Phoenix with Telemetry Part IV: Erlang VM Measurements with `telemetry_poller`" rel="prev">&laquo; Instrumenting Phoenix with Telemetry Part IV: E...</a>
      
    </div>
    <div class="6u 12u$(small)">
      
        <h4>Current article</h4>
        Real-Time SVG Charts with Contex and LiveView
      
    </div>
  </div>
</section>

<section>

    
  
    <div class="row profile">
  <div class="1u 2u(medium) 12u$(small)"><img src="https://github.com/SophieDeBenedetto.png" alt="" style="max-width: 60px;"></div>
  <div class="11u 10u(medium) 12u$(small)">
    <h2>
    
      <a href="https://github.com/SophieDeBenedetto">Sophie DeBenedetto</a>
    
    </h2>
    <p class="content">Sophie is an engineer and teacher at The Flatiron School. She loves teaching and learning and finding the Elixir School community felt like the perfect fit!</p>
    <ul class="icons">
      
      <li><a href="https://thegreatcodeadventure.com" class="icon fa-globe"><span class="label">Homepage</span></a></li>
      
      
      <li><a href="https://twitter.com/sm_debenedetto" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
      
      <li><a href="https://github.com/SophieDeBenedetto" class="icon fa-github"><span class="label">Github</span></a></li>
    </ul>
  </div>
</div>

  
</section>

				</div>
			</div>
			<!-- Sidebar -->
  <div id="sidebar">
    <p class="toggle-theme-wrapper"><a rel="noopener" href="#toggle-theme" class="toggle-theme icon fas fa-circle-o" alt="Toggle Theme" title="Toggle Theme"></a></p>

    <div class="inner">
      

      
<!-- Menu -->
<nav id="menu">
  <span class="stack-info otp-version">Elixir 1.10.1 - Erlang/OTP 22.0 [erts-10.5.3]</span>
  <header class="major">
    <h2></h2>
    <p>The premier destination for learning and mastering Elixir</p>
  </header>
  <ul>
    <li>
      <a href="/" class=" up ">Home</a>
    </li>
  
    
    
    
    
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">Basics</span>
          <ul>
        
            <li>
              
              <a href="/en/lessons/basics/basics/">1. Basics</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/collections/">2. Collections</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/enum/">3. Enum</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/pattern-matching/">4. Pattern Matching</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/control-structures/">5. Control Structures</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/functions/">6. Functions</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/pipe-operator/">7. Pipe Operator</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/modules/">8. Modules</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/mix/">9. Mix</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/sigils/">10. Sigils</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/documentation/">11. Documentation</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/testing/">12. Testing</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/comprehensions/">13. Comprehensions</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/strings/">14. Strings</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/date-time/">15. Date and Time</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/mix-tasks/">16. Custom Mix Tasks</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/basics/iex-helpers/">17. IEx Helpers</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">Advanced</span>
          <ul>
        
            <li>
              
              <a href="/en/lessons/advanced/erlang/">1. Erlang Interoperability</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/error-handling/">2. Error Handling</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/escripts/">3. Executables</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/concurrency/">4. Concurrency</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/otp-concurrency/">5. OTP Concurrency</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/otp-supervisors/">6. OTP Supervisors</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/otp-distribution/">7. OTP Distribution</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/metaprogramming/">8. Metaprogramming</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/umbrella-projects/">9. Umbrella Projects</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/typespec/">10. Specifications and types</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/behaviours/">11. Behaviours</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/gen-stage/">12. GenStage</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/advanced/protocols/">13. Protocols</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">Ecto</span>
          <ul>
        
            <li>
              
              <a href="/en/lessons/ecto/basics/">1. Basics</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/ecto/changesets/">2. Changesets</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/ecto/associations/">3. Associations</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/ecto/querying/">4. Querying</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">Specifics</span>
          <ul>
        
            <li>
              
              <a href="/en/lessons/specifics/plug/">1. Plug</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/specifics/eex/">2. Embedded Elixir (EEx)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/specifics/ets/">3. Erlang Term Storage (ETS)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/specifics/mnesia/">4. Mnesia</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/specifics/debugging/">5. Debugging</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/specifics/nerves/">6. Nerves</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    
    
    
    
    
      
        
        <li>
          <span class="opener up">Libraries</span>
          <ul>
        
            <li>
              
              <a href="/en/lessons/libraries/guardian/">1. Guardian (Basics)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/libraries/poolboy/">2. Poolboy</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/libraries/benchee/">3. Benchee</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/libraries/bypass/">4. Bypass</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/libraries/distillery/">5. Distillery (Basics)</a>
              
            </li>
        
      
        
            <li>
              
              <a href="/en/lessons/libraries/stream-data/">6. StreamData</a>
              
            </li>
        
          </ul>
        </li>
        
      
    
  
    <li>
      <a href="/blog/" class=" up active">Blog</a>
    </li>
    
    <li>
      <a href="/contributors/" class=" up ">Contributors</a>
    </li>
  </ul>
</nav>

      <!-- Footer -->
      <footer id="footer">
        <p class="copyright">&copy; 2021 <a target="_blank" rel="noopener" href="https://github.com/doomspork">Sean Callan</a> All rights reserved.</p>
      </footer>
    </div>
  </div>

		</div>
		<!-- Scripts -->

    <script async="" src="/assets/main-f8c201d2721dcb6d1d4f6acb0ebd2b2c192757ed29271f519513e4417e347611.js" type="text/javascript"></script>
		<!--[if lte IE 8]><script async="" src="/assets/ie/respond.min-8306093ccce666c01dab405fac0d16596a1d1cf38aa0ba919d4831261662cdbb.js" type="text/javascript"></script><script src="assets/js/ie/respond.min.js"></script><![endif]-->
	</body>
</html>
